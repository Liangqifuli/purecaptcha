# PureCaptcha å¿«é€Ÿé›†æˆæŒ‡å—

## ğŸ“¦ æ–‡ä»¶è¯´æ˜

```
examples/
â”œâ”€â”€ backend/                        â† åç«¯ä»£ç 
â”‚   â”œâ”€â”€ CaptchaService.java         â† Serviceå±‚ï¼ˆå¿…é¡»ï¼‰
â”‚   â”œâ”€â”€ CaptchaController.java      â† Controllerå±‚ï¼ˆå¿…é¡»ï¼‰
â”‚   â”œâ”€â”€ Application.java            â† å¯åŠ¨ç±»ï¼ˆå‚è€ƒï¼‰
â”‚   â”œâ”€â”€ pom.xml.example             â† Mavené…ç½®ï¼ˆå‚è€ƒï¼‰
â”‚   â”œâ”€â”€ application.properties.example  â† é…ç½®æ–‡ä»¶ï¼ˆå‚è€ƒï¼‰
â”‚   â””â”€â”€ ä½¿ç”¨è¯´æ˜.md                 â† è¯¦ç»†æ–‡æ¡£
â”‚
â”œâ”€â”€ frontend/                       â† å‰ç«¯ä»£ç 
â”‚   â””â”€â”€ slider-captcha-test.html   â† æµ‹è¯•é¡µé¢ï¼ˆå¯ç›´æ¥æ‰“å¼€ï¼‰
â”‚
â””â”€â”€ å¿«é€Ÿé›†æˆæŒ‡å—.md                 â† æœ¬æ–‡ä»¶
```

---

## ğŸš€ 5åˆ†é’Ÿå¿«é€Ÿé›†æˆ

### æ–¹å¼1ï¼šå¤åˆ¶åˆ°ç°æœ‰é¡¹ç›®ï¼ˆæ¨èï¼‰

#### æ­¥éª¤1ï¼šæ·»åŠ ä¾èµ–

åœ¨ `pom.xml` ä¸­æ·»åŠ ï¼š

```xml
<dependency>
    <groupId>io.github.purecaptcha</groupId>
    <artifactId>pure-captcha</artifactId>
    <version>1.0.0</version>
</dependency>
```

#### æ­¥éª¤2ï¼šå¤åˆ¶ä»£ç 

```bash
# å¤åˆ¶Serviceå’ŒControlleråˆ°ä½ çš„é¡¹ç›®
ä½ çš„é¡¹ç›®/src/main/java/com/yourcompany/yourproject/
â”œâ”€â”€ service/
â”‚   â””â”€â”€ CaptchaService.java          â† å¤åˆ¶ examples/backend/CaptchaService.java
â””â”€â”€ controller/
    â””â”€â”€ CaptchaController.java       â† å¤åˆ¶ examples/backend/CaptchaController.java
```

**âš ï¸ é‡è¦**ï¼šä¿®æ”¹æ–‡ä»¶é¡¶éƒ¨çš„åŒ…åï¼

```java
// ä¿®æ”¹å‰
package com.example.captcha.service;

// ä¿®æ”¹å
package com.yourcompany.yourproject.service;
```

#### æ­¥éª¤3ï¼šå¯åŠ¨æµ‹è¯•

```bash
# å¯åŠ¨é¡¹ç›®
mvn spring-boot:run

# æ‰“å¼€æµ‹è¯•é¡µé¢
æ‰“å¼€ examples/frontend/slider-captcha-test.html
ä¿®æ”¹å…¶ä¸­çš„ API_BASE ä¸ºä½ çš„åœ°å€
```

âœ… **å®Œæˆï¼** éªŒè¯ç å·²é›†æˆï¼

---

### æ–¹å¼2ï¼šåˆ›å»ºæ–°é¡¹ç›®ï¼ˆå®Œæ•´ç¤ºä¾‹ï¼‰

#### æ­¥éª¤1ï¼šåˆ›å»ºSpring Booté¡¹ç›®

```bash
# åˆ›å»ºé¡¹ç›®ç›®å½•
mkdir captcha-demo
cd captcha-demo

# å¤åˆ¶pom.xml
cp examples/backend/pom.xml.example pom.xml

# åˆ›å»ºç›®å½•ç»“æ„
mkdir -p src/main/java/com/example/captcha/{service,controller}
mkdir -p src/main/resources
```

#### æ­¥éª¤2ï¼šå¤åˆ¶æ‰€æœ‰æ–‡ä»¶

```bash
# å¤åˆ¶ä»£ç æ–‡ä»¶
cp examples/backend/Application.java src/main/java/com/example/captcha/
cp examples/backend/CaptchaService.java src/main/java/com/example/captcha/service/
cp examples/backend/CaptchaController.java src/main/java/com/example/captcha/controller/

# å¤åˆ¶é…ç½®æ–‡ä»¶
cp examples/backend/application.properties.example src/main/resources/application.properties
```

#### æ­¥éª¤3ï¼šå¯åŠ¨é¡¹ç›®

```bash
mvn clean package
mvn spring-boot:run
```

è®¿é—®ï¼šhttp://localhost:8080/api/captcha/slider

---

## ğŸ¯ æ ¸å¿ƒæ¥å£

### 1. ç”ŸæˆéªŒè¯ç 

```http
GET /api/captcha/slider
```

### 2. éªŒè¯

```http
POST /api/captcha/verify
Content-Type: application/json

{
  "answer": "150"
}
```

### 3. è°ƒè¯•

```http
POST /api/captcha/debug
Content-Type: application/json

{
  "answer": "150"
}
```

---

## ğŸ” æµ‹è¯•éªŒè¯

### ä½¿ç”¨å‰ç«¯æµ‹è¯•é¡µé¢

1. æ‰“å¼€ `examples/frontend/slider-captcha-test.html`
2. ä¿®æ”¹ `API_BASE` ä¸ºä½ çš„åç«¯åœ°å€
3. åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€
4. æµ‹è¯•ç”Ÿæˆå’ŒéªŒè¯

### ä½¿ç”¨Postmanæµ‹è¯•

#### ç”ŸæˆéªŒè¯ç 

```
GET http://localhost:8080/api/captcha/slider
```

**æ³¨æ„**ï¼šå‹¾é€‰ "Send cookies with requests"

#### éªŒè¯

```
POST http://localhost:8080/api/captcha/verify
Headers: Content-Type: application/json
Body (raw JSON):
{
  "answer": "150"
}
```

**æ³¨æ„**ï¼šä½¿ç”¨åŒä¸€ä¸ªSessionï¼ˆCookieï¼‰

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: éªŒè¯æ€»æ˜¯å¤±è´¥

**åŸå› **ï¼šå‰åç«¯Sessionä¸ä¸€è‡´

**è§£å†³**ï¼š
1. å‰ç«¯è¯·æ±‚æ—¶å¿…é¡»åŒ…å« `credentials: 'include'`
2. ç¡®ä¿Cookieèƒ½æ­£å¸¸ä¼ é€’
3. æ£€æŸ¥æ˜¯å¦æœ‰è·¨åŸŸé—®é¢˜

```javascript
fetch('/api/captcha/slider', {
  credentials: 'include'  // å¿…é¡»ï¼
})
```

---

### Q2: è·¨åŸŸé—®é¢˜

**ç°è±¡**ï¼šæµè§ˆå™¨ConsoleæŠ¥CORSé”™è¯¯

**è§£å†³**ï¼šåœ¨ Controller æ·»åŠ æ³¨è§£

```java
@CrossOrigin(origins = "http://localhost:3000", allowCredentials = "true")
```

æˆ–è€…é…ç½®å…¨å±€CORSï¼š

```java
@Configuration
public class WebConfig implements WebMvcConfigurer {
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/api/**")
                .allowedOrigins("http://localhost:3000")
                .allowCredentials(true)
                .allowedMethods("GET", "POST");
    }
}
```

---

### Q3: åŒ…åæŠ¥é”™

**ç°è±¡**ï¼šç¼–è¯‘æ—¶æ‰¾ä¸åˆ°ç±»

**è§£å†³**ï¼šæ£€æŸ¥åŒ…åæ˜¯å¦ä¿®æ”¹æ­£ç¡®

```java
// CaptchaService.java ç¬¬1è¡Œ
package com.example.captcha.service;  // æ”¹æˆä½ çš„åŒ…å

// CaptchaController.java ç¬¬1è¡Œ
package com.example.captcha.controller;  // æ”¹æˆä½ çš„åŒ…å

// CaptchaController.java import
import com.example.captcha.service.CaptchaService;  // æ”¹æˆä½ çš„åŒ…å
```

---

## ğŸ“Š é¡¹ç›®ç»“æ„ç¤ºä¾‹

### æ ‡å‡†Spring Booté¡¹ç›®

```
your-project/
â”œâ”€â”€ pom.xml
â”œâ”€â”€ src/
â”‚   â””â”€â”€ main/
â”‚       â”œâ”€â”€ java/
â”‚       â”‚   â””â”€â”€ com/yourcompany/yourproject/
â”‚       â”‚       â”œâ”€â”€ Application.java
â”‚       â”‚       â”œâ”€â”€ controller/
â”‚       â”‚       â”‚   â””â”€â”€ CaptchaController.java  â† å¤åˆ¶è¿™ä¸ª
â”‚       â”‚       â””â”€â”€ service/
â”‚       â”‚           â””â”€â”€ CaptchaService.java     â† å¤åˆ¶è¿™ä¸ª
â”‚       â””â”€â”€ resources/
â”‚           â””â”€â”€ application.properties
â””â”€â”€ target/
```

---

## ğŸ¨ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹éªŒè¯ç å°ºå¯¸

åœ¨ `CaptchaService.java` ä¸­ï¼š

```java
public Object generateSliderCaptcha(...) {
    CaptchaConfig.Builder configBuilder = CaptchaConfig.builder()
            .width(400)      // ä¿®æ”¹å®½åº¦
            .height(250)     // ä¿®æ”¹é«˜åº¦
            .sliderTolerance(20);  // ä¿®æ”¹å®¹å·®
    // ...
}
```

### ä¿®æ”¹è¿‡æœŸæ—¶é—´

åœ¨ `CaptchaService.java` ä¸­ï¼š

```java
private static final long EXPIRE_TIME = 10 * 60 * 1000; // æ”¹ä¸º10åˆ†é’Ÿ
```

### ç¦ç”¨å†…ç½®èƒŒæ™¯

```java
// ä½¿ç”¨é»˜è®¤ç”Ÿæˆçš„èƒŒæ™¯
configBuilder.builtinBackground(null);
```

---

## ğŸ“š å®Œæ•´æ–‡æ¡£

- **æŠ€æœ¯åŸç†**ï¼š`æ™ºèƒ½éªŒè¯ç®—æ³•è¯´æ˜.md`
- **å¿«é€Ÿå‚è€ƒ**ï¼š`æ™ºèƒ½éªŒè¯å¿«é€Ÿä½¿ç”¨.txt`
- **è¯¦ç»†è¯´æ˜**ï¼š`examples/backend/ä½¿ç”¨è¯´æ˜.md`

---

## âœ… æ£€æŸ¥æ¸…å•

é›†æˆå‰æ£€æŸ¥ï¼š

- [ ] Mavenä¾èµ–å·²æ·»åŠ ï¼ˆpure-captcha 1.0.0ï¼‰
- [ ] ä»£ç å·²å¤åˆ¶åˆ°é¡¹ç›®
- [ ] åŒ…åå·²ä¿®æ”¹
- [ ] é¡¹ç›®èƒ½æ­£å¸¸å¯åŠ¨
- [ ] å¯ä»¥è®¿é—® `/api/captcha/slider`
- [ ] å‰ç«¯èƒ½æ­£å¸¸è°ƒç”¨API
- [ ] Session/Cookie æ­£å¸¸ä¼ é€’
- [ ] éªŒè¯åŠŸèƒ½æ­£å¸¸å·¥ä½œ

---

## ğŸ‰ å®Œæˆï¼

ç°åœ¨ä½ çš„é¡¹ç›®å·²ç»é›†æˆäº†ï¼š

âœ… æ™ºèƒ½æ»‘åŠ¨éªŒè¯ç ï¼ˆ95%æˆåŠŸç‡ï¼‰  
âœ… 11å¼ é«˜æ¸…å†…ç½®èƒŒæ™¯  
âœ… è‡ªåŠ¨è¿‡æœŸæ¸…ç†  
âœ… å®Œæ•´çš„REST API  
âœ… è°ƒè¯•æ¥å£  

**æœ‰é—®é¢˜ï¼Ÿ** æŸ¥çœ‹ `examples/backend/ä½¿ç”¨è¯´æ˜.md` è·å–æ›´å¤šå¸®åŠ©ï¼

---

**ç¥ä½¿ç”¨æ„‰å¿«ï¼** ğŸš€

